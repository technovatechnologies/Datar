<html>
<head>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
    <!-- Include jsPDF and html2canvas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        @@page {
            size: A4;
            margin: 20mm;
        }
        /* Print styles */
        @@media print {
            body {
                background-color: #fff;
            }
        }
        body {
            font-family: 'Cambria Math';
            margin: 20px;
            padding: 0;
            background-color: #f8f9fa;
            
        }

        .container-box {
            max-width: 900px;
            background: white;
            border: 2px solid #000;
            padding: 20px;
            box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);
        }

        .header-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

            .header-table td {
                border: 1px solid #000;
                padding: 8px;
                text-align: left;
            }

        .title {
            font-size: 20px;
            font-weight: bold;
            background: #ddd;
        }

        td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
            vertical-align: middle;
        }


        th {
            text-align: center;
            border: 1px solid black;
            padding: 8px;
            vertical-align: middle;
            word-break: break-word;
            white-space: normal;
            overflow-wrap: break-word;
        }

        .company-title {
            font-size: 20px;
            font-weight: bold;
            letter-spacing: 1px;
            white-space: nowrap;
            word-spacing: 5px;
        }


        h1 {
            font-size: 24px;
            font-weight: bold;
        }

        h2 {
            font-size: 18px;
            font-weight: bold;
        }

        h3 {
            font-size: 16px;
            font-weight: bold;
        }

        h5 {
            font-size: 14px;
            font-weight: bold;
        }

        .underline {
            text-decoration: underline;
        }

        



        .entry {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
            margin-left: 30px;
        }
    </style>
</head>
<body>
    <!-- Close Button -->
    <a asp-area="MST_Company" id="top-logo" asp-controller="MST_Company" asp-action="CompanyDetail" class="btn btn-link position-absolute top-0 end-0 m-3 text-dark">
        <i class="bi bi-x-lg fs-4"></i>
    </a>
    <button id="downloadPdf" class="btn btn-primary my-3">Download PDF</button>

    <div class="container my-5" id="pdf-content">
        <div class="container-box mx-auto p-4">
            <table class="header-table">
                <tr>
                    <td class="company-title" colspan="2">QUALITY MANUAL</td>
                    <td class="company-title" colspan="2">BLIZZARD CERAMICA LLP</td>
                </tr>
                <tr>
                    <td colspan="2">SUBJECT : Table of contents</td>
                    <td>Edition No. : 01</td>
                </tr>
                <tr>
                    <td colspan="2">Standard : ISO 9001 : 2015</td>
                    <td>Rev. No. & Date : 01 / 01.08.2024</td>
                </tr>
                <tr>
                    <td colspan="3">Page No. : 58 of 79</td>
                </tr>
            </table>

            <div class="content">
                <p>
                    BCL is ensure that externally provided processes, products and 
                    services conform to requirements, BCL is determine the controls to
                    be applied to externally provided processes, products and services 
                    when
                </p>
                <p>
                    Products and services from external providers are intended for incorporation into the
                    Organization’s own products and services

                </p>
                <p>
                    Products and services are provided directly to the customer(s) by external providers on 
                    behalf of the organization
                </p>
                <p>
                    IN CHARGE PUR ensures that the External provided products are procured from Approved sources
                    only and which conforms to specified External provider requirement. This is done as per business
                    process flow for PROCUREMENT. The type and control to be exercised on External provider, based on 
                    the effect of the External provider’s product on the process/final product, is defined in the approved 
                    External provider list.
                </p>
                <p>
                    IN CHARGE PUR evaluates and select External provider based on their ability to supply product in 
                    accordance with the requirements of the organization. Criteria for selection, evaluation and re-evaluation 
                    are described and depicted in Business Process Flow chart.
                </p>
                <p>
                    Selection, Evaluation and approval of External providers
                </p>
                <p>
                    Periodical evaluation of External provider
                </p>
                <p>
                    Approved  External provider  List will  be  maintained  by  the  IN  CHARGE  PUR  and also  the records of 
                    their periodical performance.
                </p>
                <p>
                    Documented Information
                </p>
                <div class="container">
                    <strong>Ref.</strong><p class="entry"> List of approved Supplier <span> - D PR 01</span></p>
                    <p class="entry">External provider order monitoring and rating <span> - F PR 01</span></p>
                    <p class="entry">External provider rating analysis <span> - F PR 02</span></p>
                    <p class="entry">External provider registration form <span> - F PR 02</span></p>
                    <p class="entry">Process for external provider <span> - PC PR 01</span></p>
                </div>
                <table class="header-table">
                    <tr>
                        <td style="width:35%; height:5vh;"></td>
                        <td style="width:35%; height:5vh;"></td>
                        <td rowspan="2"></td>
                    </tr>
                    <tr>
                        <td class="text-center">Prepared By </td>
                        <td class="text-center">Approved By</td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            document.getElementById("downloadPdf").addEventListener("click", () => {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF("p", "mm", "a4");

                // Get elements to hide
                const btn = document.getElementById("downloadPdf");
                const logo = document.getElementById("top-logo");

                // Temporarily hide elements
                if (btn) btn.style.display = "none";
                if (logo) logo.style.display = "none";

                html2canvas(document.getElementById("pdf-content")).then(canvas => {
                    const imgData = canvas.toDataURL("image/png");
                    const imgWidth = 190; // A4 width in mm
                    const imgHeight = (canvas.height * imgWidth) / canvas.width;

                    pdf.addImage(imgData, "PNG", 10, 10, imgWidth, imgHeight);
                    pdf.save("QM_P58.pdf");

                    // Restore elements after PDF is generated
                    if (btn) btn.style.display = "block";
                    if (logo) logo.style.display = "block";
                });
            });
        });

    </script>
</body>
</html>
